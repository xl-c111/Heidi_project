<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post-Surgery Care Assistant</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #4facfe 0%, #00f2fe 100%);
            padding: 30px;
            color: white;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .steps {
            padding: 30px;
        }

        .step {
            margin-bottom: 40px;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #4facfe;
            background: #f8fafc;
        }

        .step h2 {
            color: #1e293b;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .upload-area {
            border: 2px dashed #4facfe;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .upload-area:hover {
            border-color: #00f2fe;
            background: #f0f9ff;
        }

        .upload-area.dragover {
            border-color: #00f2fe;
            background: #e0f2fe;
        }

        .file-input {
            display: none;
        }

        .upload-text {
            font-size: 1.1rem;
            color: #64748b;
            margin-bottom: 10px;
        }

        .upload-subtext {
            color: #94a3b8;
            font-size: 0.9rem;
        }

        .care-plan {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }

        .care-plan.show {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .care-section {
            margin-bottom: 25px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 4px solid #4facfe;
        }

        .care-section h3 {
            color: #1e293b;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .care-item {
            background: white;
            padding: 10px;
            margin: 8px 0;
            border-radius: 6px;
            border-left: 2px solid #e2e8f0;
        }

        .btn {
            background: #4facfe;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #2563eb;
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: #94a3b8;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
            color: #4facfe;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 3px solid #e2e8f0;
            border-top: 3px solid #4facfe;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .voice-section {
            background: #fef3f2;
            border-left-color: #10b981;
        }

        .record-btn {
            background: #10b981;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            margin: 10px auto;
            display: block;
            transition: all 0.3s ease;
        }

        .record-btn:hover {
            background: #059669;
            transform: scale(1.1);
        }

        .record-btn.recording {
            background: #ef4444;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .chat-response {
            background: #ecfdf5;
            border: 1px solid #10b981;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            display: none;
        }

        .chat-response.show {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè• Post-Surgery Care Assistant</h1>
            <p>Upload your discharge papers to get a personalized care plan</p>
        </div>

        <div class="steps">
            <!-- Step 1: Document Upload -->
            <div class="step">
                <h2>üìã Step 1: Upload Your Medical Documents</h2>
                <div class="upload-area" onclick="document.getElementById('file-input').click()">
                    <div class="upload-text">üìÑ Click to upload or drag & drop</div>
                    <div class="upload-subtext">Discharge papers, prescription lists, care instructions (JPG, PNG, PDF)</div>
                </div>
                <input type="file" id="file-input" class="file-input" accept=".jpg,.jpeg,.png,.pdf" onchange="handleFileUpload(event)">

                <div class="loading" id="upload-loading">
                    <div class="spinner"></div>
                    <p>Processing your document and generating care plan...</p>
                </div>

                <div class="care-plan" id="care-plan">
                    <h3>üéØ Your Personalized Care Plan</h3>
                    <div id="care-plan-content">
                        <!-- Care plan will be populated here -->
                    </div>
                </div>
            </div>

            <!-- Step 2: Voice Chat -->
            <div class="step voice-section">
                <h2>üí¨ Step 2: Ask Questions About Your Recovery</h2>
                <p style="margin-bottom: 15px;">Click the microphone to ask questions about your condition, medications, or recovery process.</p>

                <button class="record-btn" id="record-btn" onclick="toggleRecording()">üé§</button>
                <p style="text-align: center; color: #64748b; margin-bottom: 15px;" id="record-status">Click to start recording</p>

                <div class="chat-response" id="chat-response">
                    <h4>ü§ñ Heidi AI Response:</h4>
                    <div id="ai-response-content"></div>
                </div>

                <div class="loading" id="voice-loading">
                    <div class="spinner"></div>
                    <p>Processing your question...</p>
                </div>
            </div>

            <!-- Step 3: Daily Tracking -->
            <div class="step">
                <h2>üìä Step 3: Track Your Progress</h2>
                <p style="margin-bottom: 15px;">View your interactive care dashboard with medication reminders, activity tracking, and progress monitoring.</p>
                <button class="btn" onclick="openDashboard()">üì± Open My Care Dashboard</button>
            </div>
        </div>
    </div>

    <script>
        let isRecording = false;
        let mediaRecorder = null;
        let audioChunks = [];
        let currentSessionId = null;

        // File upload handling
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;

            const loading = document.getElementById('upload-loading');
            const carePlan = document.getElementById('care-plan');

            loading.classList.add('show');
            carePlan.classList.remove('show');

            // Simulate document processing and care plan generation
            setTimeout(() => {
                generateMockCarePlan();
                loading.classList.remove('show');
                carePlan.classList.add('show');
            }, 3000);

            // In real implementation, this would upload to your backend:
            // uploadToBackend(file);
        }

        function generateMockCarePlan() {
            const carePlanContent = document.getElementById('care-plan-content');
            carePlanContent.innerHTML = `
                <div class="care-section">
                    <h3>üíä Medication Schedule</h3>
                    <div class="care-item">Pain medication (Ibuprofen 400mg) - Every 6 hours with food</div>
                    <div class="care-item">Antibiotic (Amoxicillin 500mg) - 3 times daily for 7 days</div>
                    <div class="care-item">Anti-nausea medication - As needed</div>
                </div>

                <div class="care-section">
                    <h3>üö∂ Activity Guidelines</h3>
                    <div class="care-item">Short walks (5-10 minutes) every 2 hours while awake</div>
                    <div class="care-item">No lifting over 10 pounds for 2 weeks</div>
                    <div class="care-item">Deep breathing exercises 3 times daily</div>
                </div>

                <div class="care-section">
                    <h3>ü©π Wound Care</h3>
                    <div class="care-item">Change dressing daily or when wet/dirty</div>
                    <div class="care-item">Keep incision dry for first 48 hours</div>
                    <div class="care-item">Watch for signs of infection: redness, swelling, unusual discharge</div>
                </div>

                <div class="care-section">
                    <h3>‚ö†Ô∏è When to Call Doctor</h3>
                    <div class="care-item">Fever over 101¬∞F (38.3¬∞C)</div>
                    <div class="care-item">Severe pain not controlled by medication</div>
                    <div class="care-item">Signs of infection at incision site</div>
                </div>

                <div class="care-section">
                    <h3>üìÖ Follow-up Appointments</h3>
                    <div class="care-item">Post-op check: 1 week from surgery date</div>
                    <div class="care-item">Suture removal: 10-14 days post-surgery</div>
                </div>
            `;
        }

        // Voice recording handling
        async function toggleRecording() {
            const recordBtn = document.getElementById('record-btn');
            const recordStatus = document.getElementById('record-status');
            const voiceLoading = document.getElementById('voice-loading');
            const chatResponse = document.getElementById('chat-response');

            if (!isRecording) {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    mediaRecorder = new MediaRecorder(stream);
                    audioChunks = [];

                    mediaRecorder.ondataavailable = (event) => {
                        audioChunks.push(event.data);
                    };

                    mediaRecorder.onstop = () => {
                        const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                        processVoiceQuestion(audioBlob);
                    };

                    mediaRecorder.start();
                    isRecording = true;
                    recordBtn.classList.add('recording');
                    recordBtn.textContent = '‚èπÔ∏è';
                    recordStatus.textContent = 'Recording... Click to stop';
                } catch (error) {
                    alert('Could not access microphone. Please check permissions.');
                }
            } else {
                mediaRecorder.stop();
                isRecording = false;
                recordBtn.classList.remove('recording');
                recordBtn.textContent = 'üé§';
                recordStatus.textContent = 'Processing your question...';
                voiceLoading.classList.add('show');
                chatResponse.classList.remove('show');
            }
        }

        function processVoiceQuestion(audioBlob) {
            // Simulate processing voice question
            setTimeout(() => {
                const responses = [
                    "Based on your surgery type, it's normal to experience some discomfort for the first few days. Make sure you're taking your pain medication as prescribed and getting adequate rest. If pain becomes severe or unmanageable, contact your healthcare provider.",
                    "Your recovery is progressing well! Light activities like short walks are encouraged as they help prevent blood clots and promote healing. However, avoid any strenuous activities or heavy lifting as instructed.",
                    "It's important to keep your incision clean and dry. Change your dressing as directed and watch for any signs of infection like increased redness, warmth, swelling, or unusual discharge. These symptoms warrant immediate medical attention.",
                    "Your medication schedule is designed to manage pain and prevent infection. Take them exactly as prescribed, even if you're feeling better. Completing the full course of antibiotics is especially important.",
                    "Some swelling and bruising around the surgical site is normal. You can help reduce swelling by elevating the affected area when possible and applying ice as directed by your healthcare team."
                ];

                const randomResponse = responses[Math.floor(Math.random() * responses.length)];

                document.getElementById('ai-response-content').textContent = randomResponse;
                document.getElementById('voice-loading').classList.remove('show');
                document.getElementById('chat-response').classList.add('show');
                document.getElementById('record-status').textContent = 'Click to ask another question';
            }, 2000);

            // In real implementation, this would send to your backend:
            // sendVoiceToBackend(audioBlob);
        }

        function openDashboard() {
            // This would normally open the dashboard in a new tab/window
            alert('Opening your personalized care dashboard...\n\nThis would show:\n‚Ä¢ Daily medication reminders\n‚Ä¢ Progress tracking\n‚Ä¢ Appointment schedule\n‚Ä¢ Emergency contacts\n‚Ä¢ Recovery milestones');

            // In real implementation:
            // window.open('/dashboard', '_blank');
        }

        // Drag and drop functionality
        const uploadArea = document.querySelector('.upload-area');

        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');

            const files = e.dataTransfer.files;
            if (files.length > 0) {
                document.getElementById('file-input').files = files;
                handleFileUpload({ target: { files: files } });
            }
        });
    </script>
</body>
</html>